"use strict";const e=require("../../common/vendor.js"),o=require("../../store/order.js"),r=require("../../store/menu.js"),t=require("../../store/user.js"),n={setup(){const n=o.useOrderStore(),s=r.useMenuStore(),i=t.useUserStore(),d=e.computed((()=>i.isLoggedIn));e.onMounted((()=>{n.initOrders(),s.fetchMenuData()}));const c=e.computed((()=>n.allOrders.slice(0,5))),a=e.computed((()=>{const e=[];return Object.values(s.products).forEach((o=>{e.push(...o)})),e.slice(0,6)})),g=()=>{e.index.navigateTo({url:"/pages/public/login"})},u=()=>{d.value?e.index.switchTab({url:"/pages/ordering/index"}):e.index.showModal({title:"提示",content:"请先登录后再使用点餐功能",confirmText:"去登录",success:e=>{e.confirm&&g()}})};return{isLoggedIn:d,recentOrders:c,recommendProducts:a,getGreeting:()=>{const e=(new Date).getHours();return e<12?"早上好！":e<18?"下午好！":"晚上好！"},getSubtitle:()=>{const e=(new Date).getHours();return e<12?"新的一天，为TA准备早餐吧":e<14?"午餐时间，来点什么好呢？":e<18?"下午茶时光，甜蜜一下":"晚餐时间，和TA一起享受美食"},formatTime:o=>e.dayjs(o).format("MM-DD HH:mm"),goToLogin:g,goToOrdering:u,goToOrders:()=>{e.index.switchTab({url:"/pages/order/list"})},goToOrderDetail:o=>{e.index.navigateTo({url:`/pages/order/detail?id=${o}`})},goToProduct:o=>{e.index.switchTab({url:"/pages/ordering/index"})},sendLove:()=>{e.index.showToast({title:"❤️ 爱心已发送",icon:"none"})},randomFood:()=>{const o=[];if(Object.values(s.products).forEach((e=>{o.push(...e)})),o.length>0){const r=o[Math.floor(Math.random()*o.length)];e.index.showModal({title:"随机推荐",content:`今天试试 ${r.name} 怎么样？\n${r.description}`,confirmText:"去点餐",success:e=>{e.confirm&&u()}})}},shareApp:()=>{e.index.showToast({title:"分享功能开发中...",icon:"none"})}}}};if(!Array){(e.resolveComponent("u-icon")+e.resolveComponent("u-image"))()}const s=e._export_sfc(n,[["render",function(o,r,t,n,s,i){return e.e({a:e.t(n.getGreeting()),b:e.t(n.getSubtitle()),c:!n.isLoggedIn},n.isLoggedIn?{}:{d:e.o(((...e)=>n.goToLogin&&n.goToLogin(...e)))},{e:e.p({name:"sun",size:"24",color:"#FFD700"}),f:e.p({name:"shopping-cart",size:"32",color:"#FF69B4"}),g:e.o(((...e)=>n.goToOrdering&&n.goToOrdering(...e))),h:e.p({name:"list",size:"32",color:"#409EFF"}),i:e.o(((...e)=>n.goToOrders&&n.goToOrders(...e))),j:n.recentOrders.length>0},n.recentOrders.length>0?{k:e.o(((...e)=>n.goToOrders&&n.goToOrders(...e))),l:e.f(n.recentOrders.slice(0,3),((o,r,t)=>({a:e.t("sent"===o.type?"发给TA":"来自TA"),b:e.t(n.formatTime(o.createTime)),c:e.t(o.items.length),d:e.t(o.totalPrice),e:o.id,f:e.o((e=>n.goToOrderDetail(o.id)),o.id)})))}:{},{m:e.f(n.recommendProducts,((o,r,t)=>({a:"650c958d-3-"+t,b:e.p({src:o.image||"/static/images/default-product.png",width:"120",height:"120"}),c:e.t(o.name),d:e.t(o.price),e:o.id,f:e.o((e=>n.goToProduct(o)),o.id)}))),n:e.p({name:"heart-fill",size:"28",color:"#FF69B4"}),o:e.o(((...e)=>n.sendLove&&n.sendLove(...e))),p:e.p({name:"reload",size:"28",color:"#67C23A"}),q:e.o(((...e)=>n.randomFood&&n.randomFood(...e))),r:e.p({name:"share",size:"28",color:"#409EFF"}),s:e.o(((...e)=>n.shareApp&&n.shareApp(...e)))})}]]);wx.createPage(s);
