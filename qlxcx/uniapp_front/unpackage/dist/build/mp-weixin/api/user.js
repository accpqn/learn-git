"use strict";Object.defineProperty(exports,Symbol.toStringTag,{value:"Module"});const e=require("../common/vendor.js"),r=require("./request.js");var t={VITE_CJS_IGNORE_WARNING:"true",VITE_ROOT_DIR:"D:/Python/python_doc/xcx/uniapp_front",VITE_USER_NODE_ENV:"production",BASE_URL:"/",MODE:"production",DEV:!1,PROD:!0,SSR:!1};exports.getCurrentUser=function(){return r.request({url:"/users/me/",method:"GET"})},exports.login=function(e){return r.request({url:"/users/login/",method:"POST",data:e})},exports.refreshToken=function(e){return r.request({url:"/token/refresh/",method:"POST",data:{refresh:e}})},exports.respondToBinding=function(e,t){return r.request({url:`/users/${e}/respond-binding/`,method:"POST",data:{action:t}})},exports.sendBindingRequest=function(e){return r.request({url:"/users/send-binding-request/",method:"POST",data:{email:e}})},exports.sendVerificationCode=function(e){return r.request({url:"/users/send-code/",method:"POST",data:e})},exports.unbind=function(e){return r.request({url:`/users/${e}/unbind/`,method:"POST"})},exports.updateUserProfile=function(e){return r.request({url:"/users/update-profile/",method:"PUT",data:e})},exports.uploadAvatar=function(r){return new Promise(((n,o)=>{const u=e.index.getStorageSync("token");e.index.uploadFile({url:`${t.VITE_API_BASE_URL||"http://127.0.0.1:8000"}/api/users/upload-avatar/`,filePath:r,name:"avatar",header:{Authorization:`Bearer ${u}`},success:e=>{if(console.log("头像上传响应:",e),200===e.statusCode)try{const r=JSON.parse(e.data);n(r)}catch(r){o(new Error("响应数据解析失败"))}else o(new Error(`上传失败: ${e.statusCode}`))},fail:e=>{console.error("头像上传失败:",e),o(e)}})}))},exports.verifyAndLogin=function(e){return r.request({url:"/users/verify-and-login/",method:"POST",data:e})};
