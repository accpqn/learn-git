{"version":3,"file":"theme-config.js","sources":["pages/settings/theme-config.vue","../../../../App/hbuilderX/HBuilderX/plugins/uniapp-cli-vite/uniPage:/cGFnZXMvc2V0dGluZ3MvdGhlbWUtY29uZmlnLnZ1ZQ"],"sourcesContent":["<template>\n\t<view class=\"theme-config-container\" :style=\"{ '--theme-primary': themeConfig.primaryColor, '--theme-secondary': themeConfig.secondaryColor, '--theme-background': themeConfig.backgroundColor }\">\n\t\t<!-- 当前主题预览 -->\n\t\t<view class=\"current-theme-preview\">\n\t\t\t<view class=\"preview-title\">当前主题</view>\n\t\t\t<view class=\"preview-colors\">\n\t\t\t\t<view class=\"preview-color-item\">\n\t\t\t\t\t<view class=\"color-circle\" :style=\"{ backgroundColor: themeConfig.primaryColor }\"></view>\n\t\t\t\t\t<text class=\"color-name\">主色调</text>\n\t\t\t\t</view>\n\t\t\t\t<view class=\"preview-color-item\">\n\t\t\t\t\t<view class=\"color-circle\" :style=\"{ backgroundColor: themeConfig.secondaryColor }\"></view>\n\t\t\t\t\t<text class=\"color-name\">辅助色</text>\n\t\t\t\t</view>\n\t\t\t\t<view class=\"preview-color-item\">\n\t\t\t\t\t<view class=\"color-circle\" :style=\"{ backgroundColor: themeConfig.backgroundColor }\"></view>\n\t\t\t\t\t<text class=\"color-name\">背景色</text>\n\t\t\t\t</view>\n\t\t\t</view>\n\t\t</view>\n\n\t\t<!-- 颜色配置 -->\n\t\t<view class=\"config-section\">\n\t\t\t<view class=\"section-title\">自定义颜色</view>\n\t\t\t<view class=\"color-config\">\n\t\t\t\t<view class=\"color-item\">\n\t\t\t\t\t<view class=\"color-label\">主色调</view>\n\t\t\t\t\t<view class=\"color-picker\" @click=\"showColorPicker('primary')\">\n\t\t\t\t\t\t<view class=\"color-preview\" :style=\"{ backgroundColor: themeConfig.primaryColor }\"></view>\n\t\t\t\t\t\t<text class=\"color-value\">{{ themeConfig.primaryColor }}</text>\n\t\t\t\t\t</view>\n\t\t\t\t</view>\n\t\t\t\t\n\t\t\t\t<view class=\"color-item\">\n\t\t\t\t\t<view class=\"color-label\">辅助色</view>\n\t\t\t\t\t<view class=\"color-picker\" @click=\"showColorPicker('secondary')\">\n\t\t\t\t\t\t<view class=\"color-preview\" :style=\"{ backgroundColor: themeConfig.secondaryColor }\"></view>\n\t\t\t\t\t\t<text class=\"color-value\">{{ themeConfig.secondaryColor }}</text>\n\t\t\t\t\t</view>\n\t\t\t\t</view>\n\t\t\t\t\n\t\t\t\t<view class=\"color-item\">\n\t\t\t\t\t<view class=\"color-label\">背景色</view>\n\t\t\t\t\t<view class=\"color-picker\" @click=\"showColorPicker('background')\">\n\t\t\t\t\t\t<view class=\"color-preview\" :style=\"{ backgroundColor: themeConfig.backgroundColor }\"></view>\n\t\t\t\t\t\t<text class=\"color-value\">{{ themeConfig.backgroundColor }}</text>\n\t\t\t\t\t</view>\n\t\t\t\t</view>\n\t\t\t</view>\n\t\t</view>\n\n\t\t<!-- 预设主题 -->\n\t\t<view class=\"config-section\">\n\t\t\t<view class=\"section-title\">预设主题</view>\n\t\t\t<view class=\"preset-themes\">\n\t\t\t\t<view v-for=\"(preset, index) in presetThemes\" :key=\"index\" \n\t\t\t\t\t  class=\"preset-item\" \n\t\t\t\t\t  :class=\"{ active: isCurrentTheme(preset) }\"\n\t\t\t\t\t  @click=\"applyPresetTheme(preset)\">\n\t\t\t\t\t<view class=\"preset-colors\">\n\t\t\t\t\t\t<view class=\"preset-color\" :style=\"{ backgroundColor: preset.primaryColor }\"></view>\n\t\t\t\t\t\t<view class=\"preset-color\" :style=\"{ backgroundColor: preset.secondaryColor }\"></view>\n\t\t\t\t\t\t<view class=\"preset-color\" :style=\"{ backgroundColor: preset.backgroundColor }\"></view>\n\t\t\t\t\t</view>\n\t\t\t\t\t<text class=\"preset-name\">{{ preset.name }}</text>\n\t\t\t\t</view>\n\t\t\t</view>\n\t\t</view>\n\n\t\t<!-- 操作按钮 -->\n\t\t<view class=\"action-section\">\n\t\t\t<button class=\"reset-btn\" @click=\"resetTheme\">\n\t\t\t\t重置默认\n\t\t\t</button>\n\t\t\t<button class=\"save-btn\" :style=\"getButtonStyle('primary')\" @click=\"saveThemeConfig\" :loading=\"saving\">\n\t\t\t\t保存配置\n\t\t\t</button>\n\t\t</view>\n\t</view>\n</template>\n\n<script>\nimport { ref, computed, onMounted } from 'vue';\nimport { useThemeStore } from '@/store/theme';\nimport { useTheme, themeUtils } from '@/mixins/theme';\nimport { onShow } from '@dcloudio/uni-app';\n\nexport default {\n\tname: 'ThemeConfig',\n\tsetup() {\n\t\tconst themeStore = useThemeStore();\n\t\tconst { currentTheme, getThemeColor, getButtonStyle, getHeaderStyle } = useTheme();\n\t\tconst saving = ref(false);\n\n\t\t// 页面初始化\n\t\tonMounted(() => {\n\t\t\t// 确保主题已初始化\n\t\t\tif (!themeStore.initialized) {\n\t\t\t\tthemeStore.initTheme();\n\t\t\t}\n\t\t});\n\n\t\t// 页面显示时设置导航栏主题\n\t\tonShow(() => {\n\t\t\ttry {\n\t\t\t\tuni.setNavigationBarColor({\n\t\t\t\t\tfrontColor: '#ffffff',\n\t\t\t\t\tbackgroundColor: themeStore.currentTheme.primaryColor,\n\t\t\t\t\tanimation: {\n\t\t\t\t\t\tduration: 300,\n\t\t\t\t\t\ttimingFunc: 'easeIn'\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t} catch (error) {\n\t\t\t\tconsole.log('设置导航栏主题失败:', error);\n\t\t\t}\n\t\t});\n\n\t\t// 计算属性\n\t\tconst themeConfig = computed(() => currentTheme.value);\n\t\tconst presetThemes = computed(() => themeStore.presetThemes);\n\n\n\n\t\t// 显示颜色选择器\n\t\tconst showColorPicker = (type) => {\n\t\t\tconst currentColor = getThemeColor(type);\n\n\t\t\tuni.showModal({\n\t\t\t\ttitle: '输入颜色值',\n\t\t\t\tcontent: '请输入十六进制颜色值（如：#FF69B4）',\n\t\t\t\teditable: true,\n\t\t\t\tplaceholderText: currentColor,\n\t\t\t\tsuccess: (res) => {\n\t\t\t\t\tif (res.confirm && res.content) {\n\t\t\t\t\t\tconst color = res.content.trim();\n\t\t\t\t\t\tif (themeUtils.isValidColor(color)) {\n\t\t\t\t\t\t\tthemeStore.updateThemeColor(type, color);\n\t\t\t\t\t\t\tuni.showToast({\n\t\t\t\t\t\t\t\ttitle: '颜色已更新',\n\t\t\t\t\t\t\t\ticon: 'success'\n\t\t\t\t\t\t\t});\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tuni.showToast({\n\t\t\t\t\t\t\t\ttitle: '颜色格式错误，请输入如 #FF69B4 格式',\n\t\t\t\t\t\t\t\ticon: 'error'\n\t\t\t\t\t\t\t});\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t});\n\t\t};\n\n\t\t// 判断是否为当前主题\n\t\tconst isCurrentTheme = (preset) => {\n\t\t\treturn preset.primaryColor === themeConfig.value.primaryColor &&\n\t\t\t\t   preset.secondaryColor === themeConfig.value.secondaryColor &&\n\t\t\t\t   preset.backgroundColor === themeConfig.value.backgroundColor;\n\t\t};\n\n\t\t// 应用预设主题\n\t\tconst applyPresetTheme = (preset) => {\n\t\t\tthemeStore.applyPresetTheme(preset);\n\t\t\tuni.showToast({\n\t\t\t\ttitle: `已应用${preset.name}主题`,\n\t\t\t\ticon: 'success'\n\t\t\t});\n\t\t};\n\n\t\t// 保存主题配置\n\t\tconst saveThemeConfigData = async () => {\n\t\t\tsaving.value = true;\n\t\t\ttry {\n\t\t\t\tawait themeStore.saveThemeToServer();\n\t\t\t\tuni.showToast({\n\t\t\t\t\ttitle: '主题保存成功',\n\t\t\t\t\ticon: 'success'\n\t\t\t\t});\n\t\t\t} catch (error) {\n\t\t\t\tconsole.error('保存主题失败:', error);\n\t\t\t\tuni.showToast({\n\t\t\t\t\ttitle: '主题已保存到本地',\n\t\t\t\t\ticon: 'success'\n\t\t\t\t});\n\t\t\t} finally {\n\t\t\t\tsaving.value = false;\n\t\t\t}\n\t\t};\n\n\t\t// 重置主题\n\t\tconst resetTheme = () => {\n\t\t\tuni.showModal({\n\t\t\t\ttitle: '重置主题',\n\t\t\t\tcontent: '确定要重置为默认主题吗？',\n\t\t\t\tsuccess: (res) => {\n\t\t\t\t\tif (res.confirm) {\n\t\t\t\t\t\tthemeStore.resetToDefault();\n\t\t\t\t\t\tuni.showToast({\n\t\t\t\t\t\t\ttitle: '已重置为默认主题',\n\t\t\t\t\t\t\ticon: 'success'\n\t\t\t\t\t\t});\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t});\n\t\t};\n\n\t\treturn {\n\t\t\tsaving,\n\t\t\tthemeConfig,\n\t\t\tpresetThemes,\n\t\t\tshowColorPicker,\n\t\t\tisCurrentTheme,\n\t\t\tapplyPresetTheme,\n\t\t\tresetTheme,\n\t\t\tsaveThemeConfig: saveThemeConfigData,\n\t\t\tgetButtonStyle,\n\t\t\tgetHeaderStyle,\n\t\t\tgetThemeColor\n\t\t};\n\t}\n};\n</script>\n\n<style lang=\"scss\" scoped>\n.theme-config-container {\n\tmin-height: 100vh;\n\tbackground: linear-gradient(135deg, #FFF5F8 0%, #F0F8FF 100%);\n}\n\n.current-theme-preview {\n\tmargin: 30rpx;\n\tpadding: 30rpx;\n\tbackground: white;\n\tborder-radius: 20rpx;\n\tbox-shadow: 0 4rpx 20rpx rgba(0, 0, 0, 0.08);\n}\n\n.preview-title {\n\tfont-size: 32rpx;\n\tfont-weight: bold;\n\tcolor: #333;\n\tmargin-bottom: 20rpx;\n\ttext-align: center;\n}\n\n.preview-colors {\n\tdisplay: flex;\n\tjustify-content: space-around;\n\talign-items: center;\n}\n\n.preview-color-item {\n\tdisplay: flex;\n\tflex-direction: column;\n\talign-items: center;\n\tgap: 15rpx;\n}\n\n.color-circle {\n\twidth: 80rpx;\n\theight: 80rpx;\n\tborder-radius: 40rpx;\n\tborder: 3rpx solid #E0E0E0;\n\tbox-shadow: 0 4rpx 15rpx rgba(0, 0, 0, 0.1);\n}\n\n.color-name {\n\tfont-size: 24rpx;\n\tcolor: #666;\n}\n\n.config-section {\n\tmargin: 30rpx;\n\tpadding: 30rpx;\n\tbackground: white;\n\tborder-radius: 20rpx;\n\tbox-shadow: 0 4rpx 20rpx rgba(0, 0, 0, 0.08);\n}\n\n.section-title {\n\tfont-size: 32rpx;\n\tfont-weight: bold;\n\tcolor: #333;\n\tmargin-bottom: 25rpx;\n}\n\n.color-config {\n\t.color-item {\n\t\tdisplay: flex;\n\t\tjustify-content: space-between;\n\t\talign-items: center;\n\t\tpadding: 25rpx 0;\n\t\tborder-bottom: 1rpx solid #F0F0F0;\n\n\t\t&:last-child {\n\t\t\tborder-bottom: none;\n\t\t}\n\t}\n\n\t.color-label {\n\t\tfont-size: 30rpx;\n\t\tcolor: #333;\n\t}\n\n\t.color-picker {\n\t\tdisplay: flex;\n\t\talign-items: center;\n\t\tgap: 15rpx;\n\t\tcursor: pointer;\n\t\tpadding: 10rpx;\n\t\tborder-radius: 10rpx;\n\t\ttransition: all 0.3s ease;\n\n\t\t&:active {\n\t\t\tbackground: #F8F9FA;\n\t\t}\n\t}\n\n\t.color-preview {\n\t\twidth: 60rpx;\n\t\theight: 60rpx;\n\t\tborder-radius: 30rpx;\n\t\tborder: 2rpx solid #E0E0E0;\n\t}\n\n\t.color-value {\n\t\tfont-size: 26rpx;\n\t\tcolor: #666;\n\t\tfont-family: monospace;\n\t}\n}\n\n.preset-themes {\n\tdisplay: grid;\n\tgrid-template-columns: repeat(2, 1fr);\n\tgap: 20rpx;\n}\n\n.preset-item {\n\tpadding: 25rpx;\n\tborder-radius: 15rpx;\n\tborder: 2rpx solid #E0E0E0;\n\ttext-align: center;\n\tcursor: pointer;\n\ttransition: all 0.3s ease;\n\n\t&.active {\n\t\tborder-color: #FF69B4;\n\t\tbackground: #FFF5F8;\n\t\tbox-shadow: 0 4rpx 15rpx rgba(255, 105, 180, 0.2);\n\t}\n\n\t&:active {\n\t\ttransform: scale(0.95);\n\t}\n}\n\n.preset-colors {\n\tdisplay: flex;\n\tjustify-content: center;\n\tgap: 10rpx;\n\tmargin-bottom: 15rpx;\n}\n\n.preset-color {\n\twidth: 30rpx;\n\theight: 30rpx;\n\tborder-radius: 15rpx;\n\tborder: 1rpx solid #E0E0E0;\n}\n\n.preset-name {\n\tfont-size: 26rpx;\n\tcolor: #333;\n\tfont-weight: 500;\n}\n\n.action-section {\n\tpadding: 30rpx;\n\tdisplay: flex;\n\tgap: 20rpx;\n}\n\n.reset-btn {\n\tflex: 1;\n\theight: 100rpx;\n\tbackground: #F5F5F5;\n\tcolor: #666;\n\tborder: none;\n\tborder-radius: 50rpx;\n\tfont-size: 30rpx;\n\tfont-weight: bold;\n\n\t&::after {\n\t\tborder: none;\n\t}\n\n\t&:active {\n\t\tbackground: #E0E0E0;\n\t\ttransform: translateY(2rpx);\n\t}\n}\n\n.save-btn {\n\tflex: 2;\n\theight: 100rpx;\n\tborder: none;\n\tborder-radius: 50rpx;\n\tfont-size: 32rpx;\n\tfont-weight: bold;\n\n\t&::after {\n\t\tborder: none;\n\t}\n\n\t&:active {\n\t\ttransform: translateY(2rpx);\n\t}\n}\n</style>\n","import MiniProgramPage from 'D:/Python/python_doc/xcx/uniapp_front/pages/settings/theme-config.vue'\nwx.createPage(MiniProgramPage)"],"names":["useThemeStore","useTheme","ref","onMounted","onShow","uni","computed","themeUtils"],"mappings":";;;;AAuFA,MAAK,YAAU;AAAA,EACd,MAAM;AAAA,EACN,QAAQ;AACP,UAAM,aAAaA,YAAAA;AACnB,UAAM,EAAE,cAAc,eAAe,gBAAgB,eAAa,IAAMC,aAAAA;AACxE,UAAM,SAASC,kBAAI,KAAK;AAGxBC,kBAAAA,UAAU,MAAM;AAEf,UAAI,CAAC,WAAW,aAAa;AAC5B,mBAAW,UAAS;AAAA,MACrB;AAAA,IACD,CAAC;AAGDC,kBAAAA,OAAO,MAAM;AACZ,UAAI;AACHC,sBAAAA,MAAI,sBAAsB;AAAA,UACzB,YAAY;AAAA,UACZ,iBAAiB,WAAW,aAAa;AAAA,UACzC,WAAW;AAAA,YACV,UAAU;AAAA,YACV,YAAY;AAAA,UACb;AAAA,QACD,CAAC;AAAA,MACA,SAAO,OAAO;AACfA,sBAAY,MAAA,MAAA,OAAA,0CAAA,cAAc,KAAK;AAAA,MAChC;AAAA,IACD,CAAC;AAGD,UAAM,cAAcC,cAAQ,SAAC,MAAM,aAAa,KAAK;AACrD,UAAM,eAAeA,cAAQ,SAAC,MAAM,WAAW,YAAY;AAK3D,UAAM,kBAAkB,CAAC,SAAS;AACjC,YAAM,eAAe,cAAc,IAAI;AAEvCD,oBAAAA,MAAI,UAAU;AAAA,QACb,OAAO;AAAA,QACP,SAAS;AAAA,QACT,UAAU;AAAA,QACV,iBAAiB;AAAA,QACjB,SAAS,CAAC,QAAQ;AACjB,cAAI,IAAI,WAAW,IAAI,SAAS;AAC/B,kBAAM,QAAQ,IAAI,QAAQ,KAAI;AAC9B,gBAAIE,aAAU,WAAC,aAAa,KAAK,GAAG;AACnC,yBAAW,iBAAiB,MAAM,KAAK;AACvCF,4BAAAA,MAAI,UAAU;AAAA,gBACb,OAAO;AAAA,gBACP,MAAM;AAAA,cACP,CAAC;AAAA,mBACK;AACNA,4BAAAA,MAAI,UAAU;AAAA,gBACb,OAAO;AAAA,gBACP,MAAM;AAAA,cACP,CAAC;AAAA,YACF;AAAA,UACD;AAAA,QACD;AAAA,MACD,CAAC;AAAA;AAIF,UAAM,iBAAiB,CAAC,WAAW;AAClC,aAAO,OAAO,iBAAiB,YAAY,MAAM,gBAC7C,OAAO,mBAAmB,YAAY,MAAM,kBAC5C,OAAO,oBAAoB,YAAY,MAAM;AAAA;AAIlD,UAAM,mBAAmB,CAAC,WAAW;AACpC,iBAAW,iBAAiB,MAAM;AAClCA,oBAAAA,MAAI,UAAU;AAAA,QACb,OAAO,MAAM,OAAO,IAAI;AAAA,QACxB,MAAM;AAAA,MACP,CAAC;AAAA;AAIF,UAAM,sBAAsB,YAAY;AACvC,aAAO,QAAQ;AACf,UAAI;AACH,cAAM,WAAW;AACjBA,sBAAAA,MAAI,UAAU;AAAA,UACb,OAAO;AAAA,UACP,MAAM;AAAA,QACP,CAAC;AAAA,MACA,SAAO,OAAO;AACfA,sBAAA,MAAA,MAAA,SAAA,0CAAc,WAAW,KAAK;AAC9BA,sBAAAA,MAAI,UAAU;AAAA,UACb,OAAO;AAAA,UACP,MAAM;AAAA,QACP,CAAC;AAAA,MACF,UAAU;AACT,eAAO,QAAQ;AAAA,MAChB;AAAA;AAID,UAAM,aAAa,MAAM;AACxBA,oBAAAA,MAAI,UAAU;AAAA,QACb,OAAO;AAAA,QACP,SAAS;AAAA,QACT,SAAS,CAAC,QAAQ;AACjB,cAAI,IAAI,SAAS;AAChB,uBAAW,eAAc;AACzBA,0BAAAA,MAAI,UAAU;AAAA,cACb,OAAO;AAAA,cACP,MAAM;AAAA,YACP,CAAC;AAAA,UACF;AAAA,QACD;AAAA,MACD,CAAC;AAAA;AAGF,WAAO;AAAA,MACN;AAAA,MACA;AAAA,MACA;AAAA,MACA;AAAA,MACA;AAAA,MACA;AAAA,MACA;AAAA,MACA,iBAAiB;AAAA,MACjB;AAAA,MACA;AAAA,MACA;AAAA;EAEF;AACD;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AC3NA,GAAG,WAAW,eAAe;"}