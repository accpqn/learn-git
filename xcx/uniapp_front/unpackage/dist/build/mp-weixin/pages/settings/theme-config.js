"use strict";const e=require("../../common/vendor.js"),o=require("../../store/theme.js"),r=require("../../mixins/theme.js"),t={name:"ThemeConfig",setup(){const t=o.useThemeStore(),{currentTheme:n,getThemeColor:s,getButtonStyle:i,getHeaderStyle:a}=r.useTheme(),c=e.ref(!1);e.onMounted((()=>{t.initialized||t.initTheme()})),e.onShow((()=>{try{e.index.setNavigationBarColor({frontColor:"#ffffff",backgroundColor:t.currentTheme.primaryColor,animation:{duration:0,timingFunc:"linear"}})}catch(o){console.log("设置导航栏主题失败:",o)}e.index.$emit("onPageShow","pages/settings/theme-config")}));const l=e.computed((()=>n.value)),m=e.computed((()=>t.presetThemes));return{saving:c,themeConfig:l,presetThemes:m,showColorPicker:o=>{const n=s(o);e.index.showModal({title:"输入颜色值",content:"请输入十六进制颜色值（如：#FF69B4）",editable:!0,placeholderText:n,success:n=>{if(n.confirm&&n.content){const s=n.content.trim();r.themeUtils.isValidColor(s)?(t.updateThemeColor(o,s),e.index.showToast({title:"颜色已更新",icon:"success"})):e.index.showToast({title:"颜色格式错误，请输入如 #FF69B4 格式",icon:"error"})}}})},isCurrentTheme:e=>e.primaryColor===l.value.primaryColor&&e.secondaryColor===l.value.secondaryColor&&e.backgroundColor===l.value.backgroundColor,applyPresetTheme:o=>{t.applyPresetTheme(o),e.index.showToast({title:`已应用${o.name}主题`,icon:"success"})},resetTheme:()=>{e.index.showModal({title:"重置主题",content:"确定要重置为默认主题吗？",success:o=>{o.confirm&&(t.resetToDefault(),e.index.showToast({title:"已重置为默认主题",icon:"success"}))}})},saveThemeConfig:async()=>{c.value=!0;try{await t.saveThemeToServer(),e.index.showToast({title:"主题保存成功",icon:"success"})}catch(o){console.error("保存主题失败:",o),e.index.showToast({title:"主题已保存到本地",icon:"success"})}finally{c.value=!1}},getButtonStyle:i,getHeaderStyle:a,getThemeColor:s}}};const n=e._export_sfc(t,[["render",function(o,r,t,n,s,i){return{a:n.themeConfig.primaryColor,b:n.themeConfig.secondaryColor,c:n.themeConfig.backgroundColor,d:n.themeConfig.primaryColor,e:e.t(n.themeConfig.primaryColor),f:e.o((e=>n.showColorPicker("primary"))),g:n.themeConfig.secondaryColor,h:e.t(n.themeConfig.secondaryColor),i:e.o((e=>n.showColorPicker("secondary"))),j:n.themeConfig.backgroundColor,k:e.t(n.themeConfig.backgroundColor),l:e.o((e=>n.showColorPicker("background"))),m:e.f(n.presetThemes,((o,r,t)=>({a:o.primaryColor,b:o.secondaryColor,c:o.backgroundColor,d:e.t(o.name),e:r,f:n.isCurrentTheme(o)?1:"",g:e.o((e=>n.applyPresetTheme(o)),r)}))),n:e.o(((...e)=>n.resetTheme&&n.resetTheme(...e))),o:e.s(n.getButtonStyle("primary")),p:e.o(((...e)=>n.saveThemeConfig&&n.saveThemeConfig(...e))),q:n.saving,r:n.themeConfig.primaryColor,s:n.themeConfig.secondaryColor,t:n.themeConfig.backgroundColor}}],["__scopeId","data-v-c36cebb6"]]);wx.createPage(n);
