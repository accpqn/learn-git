"use strict";const e=require("../../common/vendor.js"),o=require("../../store/order.js"),r=require("../../store/menu.js"),t=require("../../store/user.js"),n=require("../../mixins/theme.js"),s={setup(){const s=o.useOrderStore(),i=r.useMenuStore(),d=t.useUserStore(),{currentTheme:c,getThemeColor:a,getButtonStyle:g,getHeaderStyle:u}=n.useTheme(),l=e.computed((()=>d.isLoggedIn));e.onMounted((()=>{s.initOrders(),i.fetchMenuData()}));const m=e.computed((()=>s.allOrders.slice(0,5))),p=e.computed((()=>{const e=[];return Object.values(i.products).forEach((o=>{e.push(...o)})),e.slice(0,6)})),T=()=>{e.index.navigateTo({url:"/pages/public/login"})},h=()=>{l.value?e.index.switchTab({url:"/pages/ordering/index"}):e.index.showModal({title:"提示",content:"请先登录后再使用点餐功能",confirmText:"去登录",success:e=>{e.confirm&&T()}})};return{isLoggedIn:l,recentOrders:m,recommendProducts:p,getGreeting:()=>{const e=(new Date).getHours();return e<12?"早上好！":e<18?"下午好！":"晚上好！"},getSubtitle:()=>{const e=(new Date).getHours();return e<12?"新的一天，为TA准备早餐吧":e<14?"午餐时间，来点什么好呢？":e<18?"下午茶时光，甜蜜一下":"晚餐时间，和TA一起享受美食"},formatTime:o=>e.dayjs(o).format("MM-DD HH:mm"),goToLogin:T,goToOrdering:h,goToOrders:()=>{e.index.switchTab({url:"/pages/order/list"})},goToOrderDetail:o=>{e.index.navigateTo({url:`/pages/order/detail?id=${o}`})},goToProduct:o=>{e.index.switchTab({url:"/pages/ordering/index"})},sendLove:()=>{e.index.showToast({title:"❤️ 爱心已发送",icon:"none"})},randomFood:()=>{const o=[];if(Object.values(i.products).forEach((e=>{o.push(...e)})),o.length>0){const r=o[Math.floor(Math.random()*o.length)];e.index.showModal({title:"随机推荐",content:`今天试试 ${r.name} 怎么样？\n${r.description}`,confirmText:"去点餐",success:e=>{e.confirm&&h()}})}},shareApp:()=>{e.index.showToast({title:"分享功能开发中...",icon:"none"})},currentTheme:c,getThemeColor:a,getButtonStyle:g,getHeaderStyle:u}}};if(!Array){(e.resolveComponent("u-icon")+e.resolveComponent("u-image"))()}const i=e._export_sfc(s,[["render",function(o,r,t,n,s,i){return e.e({a:e.t(n.getGreeting()),b:e.t(n.getSubtitle()),c:!n.isLoggedIn},n.isLoggedIn?{}:{d:e.o(((...e)=>n.goToLogin&&n.goToLogin(...e)))},{e:e.p({name:"sun",size:"24",color:"#FFD700"}),f:e.s(n.getHeaderStyle()),g:e.p({name:"shopping-cart",size:"32",color:"#FF69B4"}),h:e.o(((...e)=>n.goToOrdering&&n.goToOrdering(...e))),i:e.p({name:"list",size:"32",color:"#409EFF"}),j:e.o(((...e)=>n.goToOrders&&n.goToOrders(...e))),k:n.recentOrders.length>0},n.recentOrders.length>0?{l:e.o(((...e)=>n.goToOrders&&n.goToOrders(...e))),m:e.f(n.recentOrders.slice(0,3),((o,r,t)=>({a:e.t("sent"===o.type?"发给TA":"来自TA"),b:e.t(n.formatTime(o.createTime)),c:e.t(o.items.length),d:e.t(o.totalPrice),e:o.id,f:e.o((e=>n.goToOrderDetail(o.id)),o.id)})))}:{},{n:e.f(n.recommendProducts,((o,r,t)=>({a:"650c958d-3-"+t,b:e.p({src:o.image||"/static/images/default-product.png",width:"120",height:"120"}),c:e.t(o.name),d:e.t(o.price),e:o.id,f:e.o((e=>n.goToProduct(o)),o.id)}))),o:e.p({name:"heart-fill",size:"28",color:"#FF69B4"}),p:e.o(((...e)=>n.sendLove&&n.sendLove(...e))),q:e.p({name:"reload",size:"28",color:"#67C23A"}),r:e.o(((...e)=>n.randomFood&&n.randomFood(...e))),s:e.p({name:"share",size:"28",color:"#409EFF"}),t:e.o(((...e)=>n.shareApp&&n.shareApp(...e)))})}]]);wx.createPage(i);
