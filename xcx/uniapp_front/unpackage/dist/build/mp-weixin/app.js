"use strict";Object.defineProperty(exports,Symbol.toStringTag,{value:"Module"});const e=require("./common/vendor.js"),r=require("./store/user.js"),t=require("./store/order.js"),o=require("./store/theme.js");Math;const n={onLaunch:function(){console.log("App Launch");const n=r.useUserStore(),a=t.useOrderStore(),i=o.useThemeStore();i.initTheme().then((()=>{this.updateCSSVariables(i.currentTheme)})).catch((e=>{console.error("主题初始化失败:",e),this.updateCSSVariables(i.currentTheme)})),this.updateCSSVariables(i.currentTheme),this.updateTabBarTheme(i.currentTheme),this.updateNavigationBarTheme(i.currentTheme),e.index.$on("themeChanged",(e=>{this.updateCSSVariables(e),this.updateTabBarTheme(e),this.updateNavigationBarTheme(e)})),e.index.$on("onPageShow",(e=>{setTimeout((()=>{this.updateNavigationBarTheme(i.currentTheme,e)}),0)})),n.initFromStorage()&&n.fetchCurrentUser().catch((e=>{console.error("Failed to fetch current user:",e),n.clearUserState()})),a.initOrders()},methods:{updateCSSVariables(e){try{console.log("正在更新CSS变量:",e),console.log("小程序环境，通过动态样式绑定实现主题")}catch(r){console.log("CSS变量更新失败:",r)}},updateTabBarTheme(r){try{const t=e.index.getCurrentPages?e.index.getCurrentPages():[];if(0===t.length)return;const o=t[t.length-1].route;["pages/home/index","pages/ordering/index","pages/order/list","pages/user/index"].includes(o)&&(console.log("正在更新TabBar主题:",r),e.index.setTabBarStyle({color:"#909399",selectedColor:r.primaryColor,backgroundColor:"#ffffff",borderStyle:"white"}),console.log("TabBar主题已更新"))}catch(t){console.log("TabBar主题更新失败:",t)}},updateNavigationBarTheme(r,t=null){try{let o=t;if(!o){const r=e.index.getCurrentPages?e.index.getCurrentPages():[];if(0===r.length)return;o=r[r.length-1].route}["pages/settings/index","pages/settings/menu-manage","pages/settings/theme-config"].includes(o)&&(console.log("设置导航栏主题:",o,r.primaryColor),e.index.setNavigationBarColor({frontColor:"#ffffff",backgroundColor:r.primaryColor,animation:{duration:0,timingFunc:"linear"}}))}catch(o){console.log("导航栏主题更新失败:",o)}}},onShow:function(){console.log("App Show")},onHide:function(){console.log("App Hide")}};function a(){const r=e.createSSRApp(n),t=e.createPinia();return r.use(t),r.use(e.uviewPlus),{app:r,pinia:t}}a().app.mount("#app"),exports.createApp=a;
