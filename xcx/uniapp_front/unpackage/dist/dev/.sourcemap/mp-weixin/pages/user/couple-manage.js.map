{"version":3,"file":"couple-manage.js","sources":["pages/user/couple-manage.vue","../../../../App/hbuilderX/HBuilderX/plugins/uniapp-cli-vite/uniPage:/cGFnZXMvdXNlci9jb3VwbGUtbWFuYWdlLnZ1ZQ"],"sourcesContent":["<template>\n\t<view class=\"container\">\n\t\t<!-- 页面头部 -->\n\t\t<view class=\"header\" :style=\"getHeaderStyle()\">\n\t\t\t<text class=\"header-title\">情侣管理</text>\n\t\t\t<text class=\"header-subtitle\">管理你们的甜蜜关系</text>\n\t\t</view>\n\n\t\t<!-- 当前绑定状态 -->\n\t\t<view class=\"status-section\">\n\t\t\t<view class=\"status-card\" v-if=\"bindingInfo && bindingInfo.status === 'active'\">\n\t\t\t\t<view class=\"status-header\">\n\t\t\t\t\t<text class=\"status-icon\">💕</text>\n\t\t\t\t\t<text class=\"status-title\">已绑定情侣</text>\n\t\t\t\t</view>\n\t\t\t\t<view class=\"couple-info\">\n\t\t\t\t\t<view class=\"partner-info\">\n\t\t\t\t\t\t<image class=\"partner-avatar\" :src=\"getPartnerAvatar()\" mode=\"aspectFill\"></image>\n\t\t\t\t\t\t<view class=\"partner-details\">\n\t\t\t\t\t\t\t<text class=\"partner-name\">{{ partnerName }}</text>\n\t\t\t\t\t\t\t<text class=\"partner-email\">{{ partnerEmail }}</text>\n\t\t\t\t\t\t\t<text class=\"bind-time\">绑定时间：{{ formatDate(bindingInfo.created_at) }}</text>\n\t\t\t\t\t\t</view>\n\t\t\t\t\t</view>\n\t\t\t\t</view>\n\t\t\t\t<view class=\"status-actions\">\n\t\t\t\t\t<button class=\"action-btn info-btn\" :style=\"getButtonStyle('outline')\" @click=\"showPartnerInfo\">\n\t\t\t\t\t\t查看详情\n\t\t\t\t\t</button>\n\t\t\t\t\t<button class=\"action-btn unbind-btn\" :style=\"getButtonStyle('danger')\" @click=\"confirmUnbind\">\n\t\t\t\t\t\t解除绑定\n\t\t\t\t\t</button>\n\t\t\t\t</view>\n\t\t\t</view>\n\n\t\t\t<view class=\"status-card\" v-else-if=\"bindingInfo && bindingInfo.status === 'pending'\">\n\t\t\t\t<view class=\"status-header\">\n\t\t\t\t\t<text class=\"status-icon\">⏳</text>\n\t\t\t\t\t<text class=\"status-title\">等待对方确认</text>\n\t\t\t\t</view>\n\t\t\t\t<view class=\"pending-info\">\n\t\t\t\t\t<text class=\"pending-text\">已向 {{ bindingInfo.receiver?.email || bindingInfo.requester?.email }} 发送绑定请求</text>\n\t\t\t\t\t<text class=\"pending-time\">发送时间：{{ formatDate(bindingInfo.created_at) }}</text>\n\t\t\t\t</view>\n\t\t\t\t<view class=\"status-actions\">\n\t\t\t\t\t<button class=\"action-btn cancel-btn\" :style=\"getButtonStyle('outline')\" @click=\"cancelRequest\">\n\t\t\t\t\t\t取消请求\n\t\t\t\t\t</button>\n\t\t\t\t</view>\n\t\t\t</view>\n\n\t\t\t<view class=\"status-card\" v-else>\n\t\t\t\t<view class=\"status-header\">\n\t\t\t\t\t<text class=\"status-icon\">💔</text>\n\t\t\t\t\t<text class=\"status-title\">未绑定情侣</text>\n\t\t\t\t</view>\n\t\t\t\t<view class=\"unbind-info\">\n\t\t\t\t\t<text class=\"unbind-text\">还没有绑定情侣，快来找到你的另一半吧！</text>\n\t\t\t\t</view>\n\t\t\t\t<view class=\"status-actions\">\n\t\t\t\t\t<button class=\"action-btn bind-btn\" :style=\"getButtonStyle('primary')\" @click=\"showBindDialog\">\n\t\t\t\t\t\t绑定情侣\n\t\t\t\t\t</button>\n\t\t\t\t</view>\n\t\t\t</view>\n\t\t</view>\n\n\t\t<!-- 待处理请求 -->\n\t\t<view class=\"requests-section\" v-if=\"pendingRequests.length > 0\">\n\t\t\t<view class=\"section-title\">\n\t\t\t\t<text class=\"title-text\">待处理请求</text>\n\t\t\t\t<view class=\"title-badge\" :style=\"getBadgeStyle('count')\">{{ pendingRequests.length }}</view>\n\t\t\t</view>\n\t\t\t<view class=\"request-list\">\n\t\t\t\t<view v-for=\"request in pendingRequests\" :key=\"request.id\" class=\"request-item\">\n\t\t\t\t\t<view class=\"request-info\">\n\t\t\t\t\t\t<image class=\"requester-avatar\" :src=\"getRequesterAvatar(request)\" mode=\"aspectFill\"></image>\n\t\t\t\t\t\t<view class=\"request-details\">\n\t\t\t\t\t\t\t<text class=\"requester-name\">{{ request.requester.username }}</text>\n\t\t\t\t\t\t\t<text class=\"requester-email\">{{ request.requester.email }}</text>\n\t\t\t\t\t\t\t<text class=\"request-time\">{{ formatDate(request.created_at) }}</text>\n\t\t\t\t\t\t</view>\n\t\t\t\t\t</view>\n\t\t\t\t\t<view class=\"request-actions\">\n\t\t\t\t\t\t<button class=\"mini-btn accept-btn\" :style=\"getButtonStyle('primary')\" @click=\"acceptRequest(request)\">\n\t\t\t\t\t\t\t接受\n\t\t\t\t\t\t</button>\n\t\t\t\t\t\t<button class=\"mini-btn reject-btn\" :style=\"getButtonStyle('outline')\" @click=\"rejectRequest(request)\">\n\t\t\t\t\t\t\t拒绝\n\t\t\t\t\t\t</button>\n\t\t\t\t\t</view>\n\t\t\t\t</view>\n\t\t\t</view>\n\t\t</view>\n\n\t\t<!-- 历史记录 -->\n\t\t<view class=\"history-section\">\n\t\t\t<view class=\"section-title\">\n\t\t\t\t<text class=\"title-text\">绑定历史</text>\n\t\t\t</view>\n\t\t\t<view class=\"history-list\" v-if=\"bindingHistory.length > 0\">\n\t\t\t\t<view v-for=\"record in bindingHistory\" :key=\"record.id\" class=\"history-item\">\n\t\t\t\t\t<view class=\"history-info\">\n\t\t\t\t\t\t<text class=\"history-partner\">{{ getHistoryPartnerName(record) }}</text>\n\t\t\t\t\t\t<text class=\"history-period\">{{ formatDateRange(record.created_at, record.deleted_at) }}</text>\n\t\t\t\t\t\t<text class=\"history-status\" :class=\"getHistoryStatusClass(record)\">\n\t\t\t\t\t\t\t{{ getHistoryStatusText(record) }}\n\t\t\t\t\t\t</text>\n\t\t\t\t\t</view>\n\t\t\t\t</view>\n\t\t\t</view>\n\t\t\t<view v-else class=\"empty-history\">\n\t\t\t\t<text class=\"empty-text\">暂无绑定历史</text>\n\t\t\t</view>\n\t\t</view>\n\n\t\t<!-- 绑定对话框 -->\n\t\t<view v-if=\"showBindModal\" class=\"modal-overlay\" @click=\"closeBindDialog\">\n\t\t\t<view class=\"modal-content\" @click.stop>\n\t\t\t\t<view class=\"modal-header\">\n\t\t\t\t\t<text class=\"modal-title\">绑定情侣</text>\n\t\t\t\t\t<text class=\"modal-close\" @click=\"closeBindDialog\">×</text>\n\t\t\t\t</view>\n\t\t\t\t<view class=\"bind-form\">\n\t\t\t\t\t<view class=\"form-item\">\n\t\t\t\t\t\t<text class=\"form-label\">对方邮箱</text>\n\t\t\t\t\t\t<input class=\"form-input\" v-model=\"bindForm.email\" placeholder=\"请输入对方的邮箱地址\" />\n\t\t\t\t\t</view>\n\t\t\t\t\t<view class=\"form-item\">\n\t\t\t\t\t\t<text class=\"form-label\">绑定留言</text>\n\t\t\t\t\t\t<textarea class=\"form-textarea\" v-model=\"bindForm.message\" placeholder=\"写点什么给TA吧~（可选）\" maxlength=\"100\"></textarea>\n\t\t\t\t\t</view>\n\t\t\t\t</view>\n\t\t\t\t<view class=\"modal-actions\">\n\t\t\t\t\t<button class=\"modal-btn cancel-btn\" @click=\"closeBindDialog\">取消</button>\n\t\t\t\t\t<button class=\"modal-btn confirm-btn\" :style=\"getButtonStyle('primary')\" @click=\"sendBindRequest\">确认</button>\n\t\t\t\t</view>\n\t\t\t</view>\n\t\t</view>\n\n\t\t<!-- 详情对话框 -->\n\t\t<view v-if=\"showInfoModal\" class=\"modal-overlay\" @click=\"showInfoModal = false\">\n\t\t\t<view class=\"modal-content\" @click.stop>\n\t\t\t\t<view class=\"modal-header\">\n\t\t\t\t\t<text class=\"modal-title\">情侣信息</text>\n\t\t\t\t\t<text class=\"modal-close\" @click=\"showInfoModal = false\">×</text>\n\t\t\t\t</view>\n\t\t\t\t<view class=\"info-content\" v-if=\"bindingInfo\">\n\t\t\t\t\t<view class=\"info-item\">\n\t\t\t\t\t\t<text class=\"info-label\">对方姓名：</text>\n\t\t\t\t\t\t<text class=\"info-value\">{{ partnerName }}</text>\n\t\t\t\t\t</view>\n\t\t\t\t\t<view class=\"info-item\">\n\t\t\t\t\t\t<text class=\"info-label\">邮箱地址：</text>\n\t\t\t\t\t\t<text class=\"info-value\">{{ partnerEmail }}</text>\n\t\t\t\t\t</view>\n\t\t\t\t\t<view class=\"info-item\">\n\t\t\t\t\t\t<text class=\"info-label\">绑定时间：</text>\n\t\t\t\t\t\t<text class=\"info-value\">{{ formatDate(bindingInfo.created_at) }}</text>\n\t\t\t\t\t</view>\n\t\t\t\t\t<view class=\"info-item\">\n\t\t\t\t\t\t<text class=\"info-label\">绑定天数：</text>\n\t\t\t\t\t\t<text class=\"info-value\">{{ getBindingDays() }} 天</text>\n\t\t\t\t\t</view>\n\t\t\t\t</view>\n\t\t\t\t<view class=\"modal-actions\">\n\t\t\t\t\t<button class=\"modal-btn confirm-btn\" :style=\"getButtonStyle('primary')\" @click=\"showInfoModal = false\">确定</button>\n\t\t\t\t</view>\n\t\t\t</view>\n\t\t</view>\n\t</view>\n</template>\n\n<script>\nimport { useCoupleStore } from '@/store/couple';\nimport { useUserStore } from '@/store/user';\nimport { useTheme } from '@/mixins/theme';\nimport { ref, computed, onMounted } from 'vue';\nimport { onShow } from '@dcloudio/uni-app';\nimport dayjs from 'dayjs';\n\nexport default {\n\tsetup() {\n\t\tconst coupleStore = useCoupleStore();\n\t\tconst userStore = useUserStore();\n\t\tconst { currentTheme, getThemeColor, getButtonStyle, getHeaderStyle, getBadgeStyle } = useTheme();\n\n\t\t// 响应式数据\n\t\tconst showBindModal = ref(false);\n\t\tconst showInfoModal = ref(false);\n\t\tconst bindForm = ref({\n\t\t\temail: '',\n\t\t\tmessage: ''\n\t\t});\n\n\t\t// 计算属性\n\t\tconst bindingInfo = computed(() => coupleStore.bindingInfo);\n\t\tconst pendingRequests = computed(() => coupleStore.pendingRequests || []);\n\t\tconst bindingHistory = computed(() => coupleStore.bindingHistory || []);\n\t\tconst currentUser = computed(() => userStore.userInfo);\n\n\t\tconst partnerName = computed(() => {\n\t\t\tif (!bindingInfo.value || bindingInfo.value.status !== 'active') return '';\n\t\t\tconst currentUserId = currentUser.value?.id;\n\t\t\tif (!currentUserId) return '';\n\n\t\t\tif (bindingInfo.value.requester.id === currentUserId) {\n\t\t\t\treturn bindingInfo.value.receiver.username;\n\t\t\t} else {\n\t\t\t\treturn bindingInfo.value.requester.username;\n\t\t\t}\n\t\t});\n\n\t\tconst partnerEmail = computed(() => {\n\t\t\tif (!bindingInfo.value || bindingInfo.value.status !== 'active') return '';\n\t\t\tconst currentUserId = currentUser.value?.id;\n\t\t\tif (!currentUserId) return '';\n\n\t\t\tif (bindingInfo.value.requester.id === currentUserId) {\n\t\t\t\treturn bindingInfo.value.receiver.email;\n\t\t\t} else {\n\t\t\t\treturn bindingInfo.value.requester.email;\n\t\t\t}\n\t\t});\n\n\t\t// 生命周期\n\t\tonMounted(() => {\n\t\t\tloadCoupleData();\n\t\t});\n\n\t\tonShow(() => {\n\t\t\tloadCoupleData();\n\t\t});\n\n\t\t// 方法\n\t\tconst loadCoupleData = async () => {\n\t\t\ttry {\n\t\t\t\tawait Promise.all([\n\t\t\t\t\tcoupleStore.fetchBindingInfo(),\n\t\t\t\t\tcoupleStore.fetchPendingRequests(),\n\t\t\t\t\tcoupleStore.fetchBindingHistory()\n\t\t\t\t]);\n\t\t\t} catch (error) {\n\t\t\t\tconsole.error('加载情侣数据失败:', error);\n\t\t\t}\n\t\t};\n\n\t\tconst showBindDialog = () => {\n\t\t\tbindForm.value = { email: '', message: '' };\n\t\t\tshowBindModal.value = true;\n\t\t};\n\n\t\tconst closeBindDialog = () => {\n\t\t\tshowBindModal.value = false;\n\t\t};\n\n\t\tconst sendBindRequest = async () => {\n\t\t\tif (!bindForm.value.email) {\n\t\t\t\tuni.showToast({\n\t\t\t\t\ttitle: '请输入对方邮箱',\n\t\t\t\t\ticon: 'none'\n\t\t\t\t});\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\ttry {\n\t\t\t\tconst success = await coupleStore.sendBindingRequest(bindForm.value.email, bindForm.value.message);\n\t\t\t\tif (success) {\n\t\t\t\t\tuni.showToast({\n\t\t\t\t\t\ttitle: '绑定请求已发送',\n\t\t\t\t\t\ticon: 'success'\n\t\t\t\t\t});\n\t\t\t\t\tshowBindModal.value = false;\n\t\t\t\t\tloadCoupleData();\n\t\t\t\t}\n\t\t\t} catch (error) {\n\t\t\t\tlet errorMessage = error.message || '网络错误';\n\t\t\t\t// 优化错误信息显示\n\t\t\t\tif (errorMessage.includes('您已向该用户发起过绑定请求')) {\n\t\t\t\t\terrorMessage = '请等待对方回应，不要重复发送请求';\n\t\t\t\t} else if (errorMessage.includes('已经处于一个激活的绑定关系')) {\n\t\t\t\t\terrorMessage = '您或对方已有绑定关系';\n\t\t\t\t} else if (errorMessage.includes('该邮箱对应的用户不存在')) {\n\t\t\t\t\terrorMessage = '该邮箱用户不存在';\n\t\t\t\t}\n\n\t\t\t\tuni.showToast({\n\t\t\t\t\ttitle: errorMessage,\n\t\t\t\t\ticon: 'none',\n\t\t\t\t\tduration: 3000\n\t\t\t\t});\n\t\t\t}\n\t\t};\n\n\t\tconst acceptRequest = async (request) => {\n\t\t\ttry {\n\t\t\t\tconst success = await coupleStore.acceptBindingRequest(request.id);\n\t\t\t\tif (success) {\n\t\t\t\t\tuni.showToast({\n\t\t\t\t\t\ttitle: '已接受绑定请求',\n\t\t\t\t\t\ticon: 'success'\n\t\t\t\t\t});\n\t\t\t\t\tloadCoupleData();\n\t\t\t\t}\n\t\t\t} catch (error) {\n\t\t\t\tuni.showToast({\n\t\t\t\t\ttitle: '操作失败: ' + (error.message || '网络错误'),\n\t\t\t\t\ticon: 'none'\n\t\t\t\t});\n\t\t\t}\n\t\t};\n\n\t\tconst rejectRequest = async (request) => {\n\t\t\tuni.showModal({\n\t\t\t\ttitle: '拒绝绑定',\n\t\t\t\tcontent: `确定要拒绝来自 ${request.requester.username} 的绑定请求吗？`,\n\t\t\t\tsuccess: async (res) => {\n\t\t\t\t\tif (res.confirm) {\n\t\t\t\t\t\ttry {\n\t\t\t\t\t\t\tconst success = await coupleStore.rejectBindingRequest(request.id);\n\t\t\t\t\t\t\tif (success) {\n\t\t\t\t\t\t\t\tuni.showToast({\n\t\t\t\t\t\t\t\t\ttitle: '已拒绝绑定请求',\n\t\t\t\t\t\t\t\t\ticon: 'success'\n\t\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\t\tloadCoupleData();\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t} catch (error) {\n\t\t\t\t\t\t\tuni.showToast({\n\t\t\t\t\t\t\t\ttitle: '操作失败: ' + (error.message || '网络错误'),\n\t\t\t\t\t\t\t\ticon: 'none'\n\t\t\t\t\t\t\t});\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t});\n\t\t};\n\n\t\tconst cancelRequest = async () => {\n\t\t\tuni.showModal({\n\t\t\t\ttitle: '取消请求',\n\t\t\t\tcontent: '确定要取消绑定请求吗？',\n\t\t\t\tsuccess: async (res) => {\n\t\t\t\t\tif (res.confirm) {\n\t\t\t\t\t\ttry {\n\t\t\t\t\t\t\tconst success = await coupleStore.cancelBindingRequest();\n\t\t\t\t\t\t\tif (success) {\n\t\t\t\t\t\t\t\tuni.showToast({\n\t\t\t\t\t\t\t\t\ttitle: '已取消绑定请求',\n\t\t\t\t\t\t\t\t\ticon: 'success'\n\t\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\t\tloadCoupleData();\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t} catch (error) {\n\t\t\t\t\t\t\tuni.showToast({\n\t\t\t\t\t\t\t\ttitle: '操作失败: ' + (error.message || '网络错误'),\n\t\t\t\t\t\t\t\ticon: 'none'\n\t\t\t\t\t\t\t});\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t});\n\t\t};\n\n\t\tconst confirmUnbind = () => {\n\t\t\tuni.showModal({\n\t\t\t\ttitle: '解除绑定',\n\t\t\t\tcontent: `确定要与 ${partnerName.value} 解除绑定吗？\\n\\n解绑后：\\n• 历史数据将保留\\n• 可以重新绑定其他用户\\n• 对方也会收到解绑通知`,\n\t\t\t\tsuccess: async (res) => {\n\t\t\t\t\tif (res.confirm) {\n\t\t\t\t\t\ttry {\n\t\t\t\t\t\t\tconst success = await coupleStore.unbind();\n\t\t\t\t\t\t\tif (success) {\n\t\t\t\t\t\t\t\tuni.showToast({\n\t\t\t\t\t\t\t\t\ttitle: '已解除绑定',\n\t\t\t\t\t\t\t\t\ticon: 'success'\n\t\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\t\tloadCoupleData();\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t} catch (error) {\n\t\t\t\t\t\t\tuni.showToast({\n\t\t\t\t\t\t\t\ttitle: '操作失败: ' + (error.message || '网络错误'),\n\t\t\t\t\t\t\t\ticon: 'none'\n\t\t\t\t\t\t\t});\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t});\n\t\t};\n\n\t\tconst showPartnerInfo = () => {\n\t\t\tshowInfoModal.value = true;\n\t\t};\n\n\t\t// 工具方法\n\t\tconst formatDate = (date) => {\n\t\t\treturn dayjs(date).format('YYYY-MM-DD HH:mm');\n\t\t};\n\n\t\tconst formatDateRange = (startDate, endDate) => {\n\t\t\tconst start = dayjs(startDate).format('YYYY-MM-DD');\n\t\t\tconst end = endDate ? dayjs(endDate).format('YYYY-MM-DD') : '至今';\n\t\t\treturn `${start} ~ ${end}`;\n\t\t};\n\n\t\tconst getBindingDays = () => {\n\t\t\tif (!bindingInfo.value?.created_at) return 0;\n\t\t\treturn dayjs().diff(dayjs(bindingInfo.value.created_at), 'day');\n\t\t};\n\n\t\tconst getPartnerAvatar = () => {\n\t\t\t// 获取对方头像的逻辑\n\t\t\treturn '/static/images/default-avatar.png';\n\t\t};\n\n\t\tconst getRequesterAvatar = (requestData) => {\n\t\t\t// 获取请求者头像的逻辑\n\t\t\treturn '/static/images/default-avatar.png';\n\t\t};\n\n\t\tconst getHistoryPartnerName = (record) => {\n\t\t\tconst currentUserId = currentUser.value?.id;\n\t\t\tif (record.requester.id === currentUserId) {\n\t\t\t\treturn record.receiver.username;\n\t\t\t} else {\n\t\t\t\treturn record.requester.username;\n\t\t\t}\n\t\t};\n\n\t\tconst getHistoryStatusText = (record) => {\n\t\t\tif (record.deleted_at || record.status === 'unbound') {\n\t\t\t\treturn '已解绑';\n\t\t\t} else if (record.status === 'active') {\n\t\t\t\treturn '已绑定';\n\t\t\t} else if (record.status === 'requesting') {\n\t\t\t\treturn '等待回应';\n\t\t\t} else if (record.status === 'rejected') {\n\t\t\t\treturn '已拒绝';\n\t\t\t} else {\n\t\t\t\treturn '未知状态';\n\t\t\t}\n\t\t};\n\n\t\tconst getHistoryStatusClass = (record) => {\n\t\t\tif (record.deleted_at || record.status === 'unbound') {\n\t\t\t\treturn 'status-unbound';\n\t\t\t} else if (record.status === 'active') {\n\t\t\t\treturn 'status-active';\n\t\t\t} else if (record.status === 'requesting') {\n\t\t\t\treturn 'status-requesting';\n\t\t\t} else if (record.status === 'rejected') {\n\t\t\t\treturn 'status-rejected';\n\t\t\t} else {\n\t\t\t\treturn 'status-unknown';\n\t\t\t}\n\t\t};\n\n\t\treturn {\n\t\t\t// 数据\n\t\t\tshowBindModal,\n\t\t\tshowInfoModal,\n\t\t\tbindForm,\n\t\t\tbindingInfo,\n\t\t\tpendingRequests,\n\t\t\tbindingHistory,\n\t\t\tpartnerName,\n\t\t\tpartnerEmail,\n\t\t\t\n\t\t\t// 方法\n\t\t\tshowBindDialog,\n\t\t\tcloseBindDialog,\n\t\t\tsendBindRequest,\n\t\t\tacceptRequest,\n\t\t\trejectRequest,\n\t\t\tcancelRequest,\n\t\t\tconfirmUnbind,\n\t\t\tshowPartnerInfo,\n\t\t\tformatDate,\n\t\t\tformatDateRange,\n\t\t\tgetBindingDays,\n\t\t\tgetPartnerAvatar,\n\t\t\tgetRequesterAvatar,\n\t\t\tgetHistoryPartnerName,\n\t\t\tgetHistoryStatusText,\n\t\t\tgetHistoryStatusClass,\n\t\t\t\n\t\t\t// 主题\n\t\t\tcurrentTheme,\n\t\t\tgetThemeColor,\n\t\t\tgetButtonStyle,\n\t\t\tgetHeaderStyle,\n\t\t\tgetBadgeStyle\n\t\t};\n\t}\n};\n</script>\n\n<style lang=\"scss\" scoped>\n.container {\n\tbackground: #f8f9fa;\n\tmin-height: 100vh;\n}\n\n.header {\n\tpadding: 40rpx 30rpx;\n\tcolor: white;\n\ttext-align: center;\n}\n\n.header-title {\n\tfont-size: 36rpx;\n\tfont-weight: bold;\n\tdisplay: block;\n\tmargin-bottom: 10rpx;\n}\n\n.header-subtitle {\n\tfont-size: 24rpx;\n\topacity: 0.9;\n\tdisplay: block;\n}\n\n.status-section {\n\tpadding: 30rpx;\n}\n\n.status-card {\n\tbackground: white;\n\tborder-radius: 20rpx;\n\tpadding: 40rpx;\n\tbox-shadow: 0 4rpx 20rpx rgba(0, 0, 0, 0.08);\n}\n\n.status-header {\n\tdisplay: flex;\n\talign-items: center;\n\tmargin-bottom: 30rpx;\n}\n\n.status-icon {\n\tfont-size: 48rpx;\n\tmargin-right: 20rpx;\n}\n\n.status-title {\n\tfont-size: 32rpx;\n\tfont-weight: bold;\n\tcolor: #333;\n}\n\n.couple-info {\n\tmargin-bottom: 30rpx;\n}\n\n.partner-info {\n\tdisplay: flex;\n\talign-items: center;\n}\n\n.partner-avatar {\n\twidth: 100rpx;\n\theight: 100rpx;\n\tborder-radius: 50rpx;\n\tmargin-right: 30rpx;\n\tborder: 4rpx solid var(--theme-primary, #FF69B4);\n}\n\n.partner-details {\n\tflex: 1;\n}\n\n.partner-name {\n\tfont-size: 32rpx;\n\tfont-weight: bold;\n\tcolor: #333;\n\tdisplay: block;\n\tmargin-bottom: 10rpx;\n}\n\n.partner-email {\n\tfont-size: 26rpx;\n\tcolor: #666;\n\tdisplay: block;\n\tmargin-bottom: 10rpx;\n}\n\n.bind-time {\n\tfont-size: 24rpx;\n\tcolor: #999;\n\tdisplay: block;\n}\n\n.pending-info, .unbind-info {\n\tmargin-bottom: 30rpx;\n\ttext-align: center;\n}\n\n.pending-text, .unbind-text {\n\tfont-size: 28rpx;\n\tcolor: #666;\n\tdisplay: block;\n\tmargin-bottom: 10rpx;\n}\n\n.pending-time {\n\tfont-size: 24rpx;\n\tcolor: #999;\n\tdisplay: block;\n}\n\n.status-actions {\n\tdisplay: flex;\n\tgap: 20rpx;\n}\n\n.action-btn {\n\tflex: 1;\n\theight: 80rpx;\n\tborder-radius: 40rpx;\n\tfont-size: 28rpx;\n\tfont-weight: bold;\n\tborder: none;\n\n\t&::after {\n\t\tborder: none;\n\t}\n}\n\n.requests-section, .history-section {\n\tpadding: 0 30rpx 30rpx;\n}\n\n.section-title {\n\tdisplay: flex;\n\talign-items: center;\n\tmargin-bottom: 20rpx;\n}\n\n.title-text {\n\tfont-size: 30rpx;\n\tfont-weight: bold;\n\tcolor: #333;\n\tmargin-right: 15rpx;\n}\n\n.title-badge {\n\tmin-width: 40rpx;\n\theight: 40rpx;\n\tborder-radius: 20rpx;\n\tdisplay: flex;\n\talign-items: center;\n\tjustify-content: center;\n\tfont-size: 20rpx;\n\tcolor: white;\n\tfont-weight: bold;\n}\n\n.request-list, .history-list {\n\tbackground: white;\n\tborder-radius: 20rpx;\n\toverflow: hidden;\n\tbox-shadow: 0 4rpx 20rpx rgba(0, 0, 0, 0.08);\n}\n\n.request-item, .history-item {\n\tpadding: 30rpx;\n\tborder-bottom: 1rpx solid #f0f0f0;\n\n\t&:last-child {\n\t\tborder-bottom: none;\n\t}\n}\n\n.request-info {\n\tdisplay: flex;\n\talign-items: center;\n\tmargin-bottom: 20rpx;\n}\n\n.requester-avatar {\n\twidth: 80rpx;\n\theight: 80rpx;\n\tborder-radius: 40rpx;\n\tmargin-right: 20rpx;\n}\n\n.request-details {\n\tflex: 1;\n}\n\n.requester-name {\n\tfont-size: 28rpx;\n\tfont-weight: bold;\n\tcolor: #333;\n\tdisplay: block;\n\tmargin-bottom: 8rpx;\n}\n\n.requester-email {\n\tfont-size: 24rpx;\n\tcolor: #666;\n\tdisplay: block;\n\tmargin-bottom: 8rpx;\n}\n\n.request-time {\n\tfont-size: 22rpx;\n\tcolor: #999;\n\tdisplay: block;\n}\n\n.request-actions {\n\tdisplay: flex;\n\tgap: 15rpx;\n}\n\n.mini-btn {\n\theight: 60rpx;\n\tpadding: 0 30rpx;\n\tborder-radius: 30rpx;\n\tfont-size: 24rpx;\n\tborder: none;\n\n\t&::after {\n\t\tborder: none;\n\t}\n}\n\n.history-info {\n\tdisplay: flex;\n\tflex-direction: column;\n}\n\n.history-partner {\n\tfont-size: 28rpx;\n\tfont-weight: bold;\n\tcolor: #333;\n\tmargin-bottom: 10rpx;\n}\n\n.history-period {\n\tfont-size: 24rpx;\n\tcolor: #666;\n\tmargin-bottom: 10rpx;\n}\n\n.history-status {\n\tfont-size: 22rpx;\n\tpadding: 4rpx 12rpx;\n\tborder-radius: 12rpx;\n\talign-self: flex-start;\n\n\t&.status-active {\n\t\tbackground: #d4edda;\n\t\tcolor: #155724;\n\t}\n\n\t&.status-unbound {\n\t\tbackground: #f8d7da;\n\t\tcolor: #721c24;\n\t}\n\n\t&.status-requesting {\n\t\tbackground: #fff3cd;\n\t\tcolor: #856404;\n\t}\n\n\t&.status-rejected {\n\t\tbackground: #f5f5f5;\n\t\tcolor: #999;\n\t}\n\n\t&.status-unknown {\n\t\tbackground: #e2e3e5;\n\t\tcolor: #6c757d;\n\t}\n}\n\n.empty-history {\n\tbackground: white;\n\tborder-radius: 20rpx;\n\tpadding: 80rpx;\n\ttext-align: center;\n\tbox-shadow: 0 4rpx 20rpx rgba(0, 0, 0, 0.08);\n}\n\n.empty-text {\n\tfont-size: 28rpx;\n\tcolor: #999;\n}\n\n.bind-form {\n\tpadding: 20rpx 0;\n}\n\n.form-item {\n\tmargin-bottom: 30rpx;\n}\n\n.form-label {\n\tfont-size: 28rpx;\n\tcolor: #333;\n\tfont-weight: bold;\n\tdisplay: block;\n\tmargin-bottom: 15rpx;\n}\n\n.form-input, .form-textarea {\n\twidth: 100%;\n\tpadding: 20rpx;\n\tborder: 2rpx solid #e0e0e0;\n\tborder-radius: 10rpx;\n\tfont-size: 26rpx;\n\tbackground: #f8f9fa;\n\n\t&:focus {\n\t\tborder-color: var(--theme-primary, #FF69B4);\n\t\tbackground: white;\n\t}\n}\n\n.form-textarea {\n\theight: 120rpx;\n\tresize: none;\n}\n\n.info-content {\n\tpadding: 20rpx 0;\n}\n\n.info-item {\n\tdisplay: flex;\n\tmargin-bottom: 20rpx;\n}\n\n.info-label {\n\tfont-size: 26rpx;\n\tcolor: #666;\n\twidth: 160rpx;\n}\n\n.info-value {\n\tfont-size: 26rpx;\n\tcolor: #333;\n\tflex: 1;\n}\n\n// 模态框样式\n.modal-overlay {\n\tposition: fixed;\n\ttop: 0;\n\tleft: 0;\n\tright: 0;\n\tbottom: 0;\n\tbackground: rgba(0, 0, 0, 0.5);\n\tdisplay: flex;\n\talign-items: center;\n\tjustify-content: center;\n\tz-index: 1000;\n}\n\n.modal-content {\n\tbackground: white;\n\tborder-radius: 20rpx;\n\twidth: 90%;\n\tmax-width: 600rpx;\n\tmax-height: 80vh;\n\toverflow: hidden;\n}\n\n.modal-header {\n\tdisplay: flex;\n\talign-items: center;\n\tjustify-content: space-between;\n\tpadding: 30rpx;\n\tborder-bottom: 1rpx solid #f0f0f0;\n}\n\n.modal-title {\n\tfont-size: 32rpx;\n\tfont-weight: bold;\n\tcolor: #333;\n}\n\n.modal-close {\n\tfont-size: 40rpx;\n\tcolor: #999;\n\twidth: 60rpx;\n\theight: 60rpx;\n\tdisplay: flex;\n\talign-items: center;\n\tjustify-content: center;\n\tborder-radius: 30rpx;\n\n\t&:active {\n\t\tbackground: #f0f0f0;\n\t}\n}\n\n.modal-actions {\n\tdisplay: flex;\n\tgap: 20rpx;\n\tpadding: 30rpx;\n\tborder-top: 1rpx solid #f0f0f0;\n}\n\n.modal-btn {\n\tflex: 1;\n\theight: 80rpx;\n\tborder-radius: 40rpx;\n\tfont-size: 28rpx;\n\tfont-weight: bold;\n\tborder: none;\n\n\t&::after {\n\t\tborder: none;\n\t}\n\n\t&.cancel-btn {\n\t\tbackground: #f5f5f5;\n\t\tcolor: #666;\n\t}\n}\n</style>\n","import MiniProgramPage from 'D:/Python/python_doc/xcx/uniapp_front/pages/user/couple-manage.vue'\nwx.createPage(MiniProgramPage)"],"names":["useCoupleStore","useUserStore","useTheme","ref","computed","onMounted","onShow","uni","dayjs"],"mappings":"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"}