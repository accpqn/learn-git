{"version":3,"file":"theme.js","sources":["mixins/theme.js"],"sourcesContent":["import { useThemeStore } from '@/store/theme';\nimport { computed, onMounted, onUnmounted } from 'vue';\n\n/**\n * 主题混入 - 为组件提供主题相关的功能\n */\nexport function useTheme() {\n    const themeStore = useThemeStore();\n    \n    // 当前主题配置\n    const currentTheme = computed(() => themeStore.currentTheme);\n    \n    // 主题CSS变量\n    const themeVars = computed(() => themeStore.cssVariables);\n    \n    // 主题样式对象\n    const themeStyles = computed(() => ({\n        '--theme-primary': currentTheme.value.primaryColor,\n        '--theme-secondary': currentTheme.value.secondaryColor,\n        '--theme-background': currentTheme.value.backgroundColor,\n        '--theme-primary-light': currentTheme.value.primaryColor + '20',\n        '--theme-secondary-light': currentTheme.value.secondaryColor + '20'\n    }));\n\n    // 获取主题颜色的方法\n    const getThemeColor = (type = 'primary') => {\n        switch (type) {\n            case 'primary':\n                return currentTheme.value.primaryColor;\n            case 'secondary':\n                return currentTheme.value.secondaryColor;\n            case 'background':\n                return currentTheme.value.backgroundColor;\n            default:\n                return currentTheme.value.primaryColor;\n        }\n    };\n\n    // 获取渐变背景样式\n    const getGradientStyle = (direction = '135deg') => {\n        return {\n            background: `linear-gradient(${direction}, ${currentTheme.value.primaryColor}, ${currentTheme.value.secondaryColor})`\n        };\n    };\n\n    // 获取主题按钮样式\n    const getButtonStyle = (type = 'primary') => {\n        const baseStyle = {\n            borderRadius: '40rpx',\n            border: 'none',\n            fontWeight: 'bold'\n        };\n\n        switch (type) {\n            case 'primary':\n                return {\n                    ...baseStyle,\n                    background: `linear-gradient(135deg, ${currentTheme.value.primaryColor}, ${currentTheme.value.secondaryColor})`,\n                    color: 'white',\n                    boxShadow: `0 8rpx 25rpx ${currentTheme.value.primaryColor}40`\n                };\n            case 'secondary':\n                return {\n                    ...baseStyle,\n                    background: currentTheme.value.backgroundColor,\n                    color: currentTheme.value.primaryColor,\n                    border: `2rpx solid ${currentTheme.value.primaryColor}`\n                };\n            case 'outline':\n                return {\n                    ...baseStyle,\n                    background: 'transparent',\n                    color: currentTheme.value.primaryColor,\n                    border: `2rpx solid ${currentTheme.value.primaryColor}`\n                };\n            default:\n                return baseStyle;\n        }\n    };\n\n    // 获取卡片样式\n    const getCardStyle = () => {\n        return {\n            background: 'white',\n            borderRadius: '20rpx',\n            boxShadow: '0 4rpx 20rpx rgba(0, 0, 0, 0.08)',\n            border: `1rpx solid ${currentTheme.value.backgroundColor}`\n        };\n    };\n\n    // 获取头部样式\n    const getHeaderStyle = () => {\n        return {\n            background: `linear-gradient(135deg, ${currentTheme.value.primaryColor}, ${currentTheme.value.secondaryColor})`,\n            color: 'white'\n        };\n    };\n\n    // 获取价格样式\n    const getPriceStyle = (size = 'medium') => {\n        const sizeMap = {\n            small: { fontSize: '24rpx' },\n            medium: { fontSize: '28rpx' },\n            large: { fontSize: '36rpx' }\n        };\n\n        return {\n            color: currentTheme.value.primaryColor,\n            fontWeight: 'bold',\n            ...sizeMap[size]\n        };\n    };\n\n    // 获取徽章样式\n    const getBadgeStyle = (type = 'primary') => {\n        const baseStyle = {\n            borderRadius: '20rpx',\n            padding: '4rpx 8rpx',\n            fontSize: '20rpx',\n            color: 'white',\n            fontWeight: 'bold'\n        };\n\n        switch (type) {\n            case 'primary':\n                return {\n                    ...baseStyle,\n                    background: currentTheme.value.primaryColor\n                };\n            case 'secondary':\n                return {\n                    ...baseStyle,\n                    background: currentTheme.value.secondaryColor\n                };\n            case 'count':\n                return {\n                    ...baseStyle,\n                    background: currentTheme.value.primaryColor,\n                    minWidth: '32rpx',\n                    textAlign: 'center'\n                };\n            default:\n                return baseStyle;\n        }\n    };\n\n    // 获取Tab样式\n    const getTabStyle = (isActive = false) => {\n        if (isActive) {\n            return {\n                color: currentTheme.value.primaryColor,\n                fontWeight: 'bold',\n                borderBottom: `4rpx solid ${currentTheme.value.primaryColor}`\n            };\n        }\n        return {\n            color: '#666',\n            fontWeight: 'normal'\n        };\n    };\n\n    // 主题变化监听\n    let themeChangeListener = null;\n\n    onMounted(() => {\n        // 监听主题变化事件\n        themeChangeListener = (newTheme) => {\n            console.log('主题已更新:', newTheme);\n            // 可以在这里添加主题变化后的处理逻辑\n        };\n        \n        uni.$on('themeChanged', themeChangeListener);\n        \n        // 初始化主题\n        if (!themeStore.initialized) {\n            themeStore.initTheme();\n        }\n    });\n\n    onUnmounted(() => {\n        // 移除事件监听\n        if (themeChangeListener) {\n            uni.$off('themeChanged', themeChangeListener);\n        }\n    });\n\n    return {\n        // 状态\n        currentTheme,\n        themeVars,\n        themeStyles,\n        \n        // 方法\n        getThemeColor,\n        getGradientStyle,\n        getButtonStyle,\n        getCardStyle,\n        getHeaderStyle,\n        getPriceStyle,\n        getBadgeStyle,\n        getTabStyle,\n        \n        // Store方法\n        applyPresetTheme: themeStore.applyPresetTheme,\n        updateThemeColor: themeStore.updateThemeColor,\n        saveThemeToServer: themeStore.saveThemeToServer,\n        resetToDefault: themeStore.resetToDefault\n    };\n}\n\n/**\n * 主题工具函数\n */\nexport const themeUtils = {\n    // 颜色验证\n    isValidColor(color) {\n        return /^#[0-9A-Fa-f]{6}$/.test(color);\n    },\n\n    // 颜色亮度计算\n    getColorBrightness(color) {\n        const hex = color.replace('#', '');\n        const r = parseInt(hex.substr(0, 2), 16);\n        const g = parseInt(hex.substr(2, 2), 16);\n        const b = parseInt(hex.substr(4, 2), 16);\n        return (r * 299 + g * 587 + b * 114) / 1000;\n    },\n\n    // 判断是否为深色\n    isDarkColor(color) {\n        return this.getColorBrightness(color) < 128;\n    },\n\n    // 获取对比色（黑色或白色）\n    getContrastColor(color) {\n        return this.isDarkColor(color) ? '#FFFFFF' : '#000000';\n    },\n\n    // 颜色透明度处理\n    addAlpha(color, alpha) {\n        const hex = color.replace('#', '');\n        const alphaHex = Math.round(alpha * 255).toString(16).padStart(2, '0');\n        return `#${hex}${alphaHex}`;\n    }\n};\n"],"names":["useThemeStore","computed","onMounted","uni","onUnmounted"],"mappings":"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"}